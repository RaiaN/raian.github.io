<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:hsla(0,0%,0%,0.59);font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"— ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:none;color:black;text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a:hover{color:orange;text-decoration:none;box-shadow:none;}</style><meta name="generator" content="Gatsby 5.7.0"/><meta data-react-helmet="true" name="description" content="In this article I will outline the most optimal approach to create textures in Unreal at runtime without hitches."/><meta data-react-helmet="true" property="og:title" content="Efficient and asynchronous creation of textures at runtime in Unreal Engine"/><meta data-react-helmet="true" property="og:description" content="In this article I will outline the most optimal approach to create textures in Unreal at runtime without hitches."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Petr Leontev"/><meta data-react-helmet="true" name="twitter:title" content="Efficient and asynchronous creation of textures at runtime in Unreal Engine"/><meta data-react-helmet="true" name="twitter:description" content="In this article I will outline the most optimal approach to create textures in Unreal at runtime without hitches."/><meta data-react-helmet="true" name="keywords" content="blog, unreal engine"/><style data-href="/styles.38c555d8219e442f87b4.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-fc117160c69a8ea0851b26dd14748ee4.woff2) format("woff2"),url(/static/merriweather-latin-300-58b18067ebbd21fda77b67e73c241d3b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-fe29961474f8dbf77c0aa7b9a629e4bc.woff2) format("woff2"),url(/static/merriweather-latin-300italic-23c3f1f88683618a4fb8d265d33d383a.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-d9479e8023bef9cbd9bf8d6eabd6bf36.woff2) format("woff2"),url(/static/merriweather-latin-400-040426f99ff6e00b86506452e0d1f10b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-2de7bfeaf08fb03d4315d49947f062f7.woff2) format("woff2"),url(/static/merriweather-latin-400italic-79db67aca65f5285964ab332bd65f451.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-4b08e01d805fa35d7bf777f1b24314ae.woff2) format("woff2"),url(/static/merriweather-latin-700-22fb8afba4ab1f093b6ef9e28a9b6e92.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-cd92541b177652fffb6e3b952f1c33f1.woff2) format("woff2"),url(/static/merriweather-latin-700italic-f87f3d87cea0dd0979bfc8ac9ea90243.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-f813fc6a4bee46eda5224ac7ebf1b7be.woff2) format("woff2"),url(/static/merriweather-latin-900-5d4e42cb44410674acd99153d57df032.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-b7901d85486871c1779c0e93ddd85656.woff2) format("woff2"),url(/static/merriweather-latin-900italic-9647f9fdab98756989a8a5550eb205c3.woff) format("woff")}body{background-image:url(/static/whitenoise-e7499399fb563a3fb7cd2d9c8d15c78c.png)}li{margin-bottom:0}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:visible;padding:1px;position:relative}pre[class*=language-]>code{background-attachment:local;background-color:#fdfdfd;background-image:linear-gradient(transparent 50%,rgba(69,142,209,.04) 0);background-origin:content-box;background-size:3em 3em;border-left:10px solid #358ccb;box-shadow:-1px 0 0 0 #358ccb,0 0 0 1px #dfdfdf;position:relative;z-index:1}code[class*=language-]{display:block;height:inherit;max-height:inherit;overflow:auto;padding:0 1em}:not(pre)>code[class*=language-],pre[class*=language-]{background-color:#fdfdfd;box-sizing:border-box;margin-bottom:1em}:not(pre)>code[class*=language-]{border:1px solid rgba(0,0,0,.1);border-radius:.3em;color:#c92c2c;display:inline;padding:.2em;position:relative;white-space:normal}pre[class*=language-]:after,pre[class*=language-]:before{bottom:.75em;box-shadow:0 13px 8px #979797;content:"";display:block;height:20%;left:.18em;max-height:13em;position:absolute;transform:rotate(-2deg);width:40%}pre[class*=language-]:after{left:auto;right:.75em;transform:rotate(2deg)}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#7d8b99}.token.punctuation{color:#5f6364}.token.boolean,.token.constant,.token.deleted,.token.function-name,.token.number,.token.property,.token.symbol,.token.tag{color:#c92c2c}.token.attr-name,.token.builtin,.token.char,.token.function,.token.inserted,.token.selector,.token.string{color:#2f9c0a}.token.entity,.token.operator,.token.url,.token.variable{background:hsla(0,0%,100%,.5);color:#a67f59}.token.atrule,.token.attr-value,.token.class-name,.token.keyword{color:#1990b8}.token.important,.token.regex{color:#e90}.language-css .token.string,.style .token.string{background:hsla(0,0%,100%,.5);color:#a67f59}.token.important{font-weight:400}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.namespace{opacity:.7}@media screen and (max-width:767px){pre[class*=language-]:after,pre[class*=language-]:before{bottom:14px;box-shadow:none}}pre[class*=language-].line-numbers.line-numbers{padding-left:0}pre[class*=language-].line-numbers.line-numbers code{padding-left:3.8em}pre[class*=language-].line-numbers.line-numbers .line-numbers-rows{left:0}pre[class*=language-][data-line]{padding-bottom:0;padding-left:0;padding-top:0}pre[data-line] code{padding-left:4em;position:relative}pre .line-highlight{margin-top:0}</style><title data-react-helmet="true" class="jsx-679949698">Petr Leontev - Tech Entrepreneur &amp; Unreal Engineer  | Efficient and asynchronous creation of textures at runtime in Unreal Engine</title><link data-react-helmet="true" rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsSAAALEgHS3X78AAAAB3RJTUUH4wQWCTow0Fe4VQAAASBJREFUaN7t101Kw0AYh/FfStwKeoHi2rUg0r2C4N4DuPAo4gk8h4eQIq5EN34dQBfa7vwgbiKUodCS1jQD7wMhvIF/kifMvJkhCIIgCDKmSOpqjkyFEd7xgCEu6/O8VDPeozHVAsc1dho+RxcEKnzipEsC0+hhEwOcY5xkvnHQZYGULdwluSeUuQj8SYyS7HEbAr0lib/gIrm2v4q2usiXGSTZ+5yGkHpiT2bfchMop7TUbOYArCf1RxtjfpkC20n9mpvAUVIPc+pC/VX9B5Zx4z5uk9wz1roqUGADezirJ+tk5geHua5Gv3Ca63L6Brtt7wfKhpLjekf2OLEju1pF15klUOg4PZkTAiEQAiEQAv/6I2tzGR9DKAiCIAiy4xcOsNjd4974mwAAAABJRU5ErkJggg==" class="jsx-679949698"/><style id="__jsx-580389387">li.jsx-580389387{display:inline-block;margin-right:0em;margin-left:1em;}@media (max-width:500px){li.jsx-580389387{display:inline-block;margin-right:1em;margin-left:0em;}}</style><style id="__jsx-998478337">li.jsx-998478337{display:inline-block;margin-right:0em;margin-left:1em;}@media (max-width:500px){li.jsx-998478337{display:inline-block;margin-right:1em;margin-left:0em;}}</style><style id="__jsx-679949698">.layout-container.jsx-679949698{margin:2rem auto;max-width:900px;padding:1rem;}.layout-header.jsx-679949698{margin-left:0px;margin-bottom:16vm;display:inline;}.author.jsx-679949698{display:inline;}.navigation.jsx-679949698{float:right;margin-bottom:0;display:inline-block;}.layout-content.jsx-679949698{margin-top:2.5em;}@media (max-width:500px){.author.jsx-679949698{margin-top:0px;margin-bottom:1px;display:block;}.navigation.jsx-679949698{margin-left:0px;float:none;}.layout-content.jsx-679949698{margin-top:0.5em;}}</style><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="jsx-679949698 layout-container"><header class="jsx-679949698 layout-header"><a href="/"><h2 class="jsx-679949698 author">Petr Leontev</h2></a><ul class="jsx-679949698 navigation"><li class="jsx-580389387"><a href="/about/"><b class="jsx-679949698">About</b></a></li><li class="jsx-580389387"><a href="/"><b class="jsx-679949698">Blog</b></a></li><li class="jsx-998478337"><a href="/static/petr_leontev_cv_sa-2d981d9dfd938591a3bc96007ee26514.pdf" target="_blank" rel="noopener noreferrer" class="jsx-998478337"><b class="jsx-998478337">CV</b></a></li></ul></header><div class="jsx-679949698 layout-content"><a href="/"><h3 style="margin:0;margin-bottom:3.5rem">Blog</h3></a><div><main><h4 style="margin-bottom:7px;margin-top:0"><i>Efficient and asynchronous creation of textures at runtime in Unreal Engine</i></h4><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:0.58333rem;margin-top:0">March 13, 2022</p><p>UPD 2023: outlined approach was tested with DirectX 11/12, OpenGL, Vulkan and Metal graphics APIs.</p>
<p><strong>Basics</strong></p>
<p>Once Unreal engine developer starts to think about loading an image at runtime (from disk, network, etc.) it usually leads to the following solution:</p>
<pre><code class="language-cpp">uint32 TextureSizeX = 1024;
uint32 TextureSizeY = 1024;
EPixelFormat TextureFormat = PF_B8G8R8A8;

// game thread code
// create texture
UTexture2D *Texture = UTexture2D::CreateTransient(TextureSizeX, TextureSizeY, TextureFormat);

// Lock and copies the source data to target
void* TargetTextureData = Texture-&gt;PlatformData-&gt;Mips[0].BulkData.Lock(LOCK_READ_WRITE);
{
	const int32 TextureDataSize = CalculateTextureBytes(TextureSizeX, TextureSizeY, TextureFormat);
	FMemory::Memcpy(TargetTextureData, SourceTextureData, TextureDataSize);
}
Texture-&gt;PlatformData-&gt;Mips[0].BulkData.Unlock();

// Upload mipmaps data to GPU memory
Texture-&gt;UpdateResource();
</code></pre>
<p>Can the above code be used? Sure. It is a simple solution, which works well for medium-resolution images. However it is sub-optimal or even bad approach when a set of high resolution images (4k or even 8k) needs to be loaded at runtime without overloading render thread.</p>
<p><strong>Root cause of the render thread hitch</strong></p>
<p>There are few issues that developer probably wants to address before shipping the simple &quot;load image at runtime&quot; code into production:</p>
<ol>
<li>RHI thread stall (it actually happens on render thread)</li>
<li>Texture and shader resource view (SRV) objects construction</li>
<li>Redundant RHI calls</li>
</ol>
<p>Lets look at each one of them.</p>
<p><em>Texture-&gt;UpdateResource();</em> leads to so-called synchronous creation of resources in DirectX, which in turn requires to stall RHI thread that is responsible for executing commands via graphics API (i.e. DirectX). The stall here means the current thread has to wait until RHI thread tasks are completed. What happens when there is a heavy scene and user logic should load an image? Right, the render thread hitch.</p>
<p>Synchronous texture creation consists of two steps: texture object and corresponding shader resource view (SRV) object construction. If both happen on the render thread then depending on the texture params like a resolution, a number of mip-maps and a pixel format it may take a while.</p>
<p>What about redundant RHI calls? First of call, the below code only fills the mipmaps data on CPU side.</p>
<pre><code class="language-cpp">// Lock and copies the source mipmaps data to target buffer:
void* TargetTextureData = Texture-&gt;PlatformData-&gt;Mips[0].BulkData.Lock(LOCK_READ_WRITE);
{
	const int32 TextureDataSize = CalculateTextureBytes(TextureSizeX, TextureSizeY, TextureFormat);
	FMemory::Memcpy(TargetTextureData, SourceTextureData, TextureDataSize);
}
Texture-&gt;PlatformData-&gt;Mips[0].BulkData.Unlock();
</code></pre>
<p>How the mipmaps end up uploaded to GPU memory? That is what <em>Texture-&gt;UpdateResource();</em> does (besides a ton of other things). It creates <em>FTexture2DResource</em>, constructs RHI texture via <em>RHICreateTexture2D</em> and fills mipmaps one by one using RHI calls like <em>RHILockTexture</em> and <em>RHIUnlockTexture</em> (these also stall RHI thread, surprise!). Sounds like a lot? Well, there are even more things going on under the hood!</p>
<p>To sump up the cost of calling <em>Texture-&gt;UpdateResource()</em> is huge! There must be a better approach to load an image at runtime == better approach to construct textures in Unreal Engine.</p>
<p><strong>Asynchronous texture creation</strong></p>
<p>First step is to eliminate as many RHI thread stalls as possible. There is an efficient way to construct RHI texture and SRV. One can use it by calling <em>RHIAsyncCreateTexture2D</em> from outside the render thread. It returns <em>FTexture2DRHIRef</em> that can later be linked to <em>UTexture2D</em>.</p>
<p>Second step requires to create UTexture2D using dummy information. It is as simple as allocating a single 1x1 mipmap on CPU and calling <em>Texture-&gt;UpdateResource();</em>. In this case it won&#x27;t take as much time as constructing a texture of a required resolution.</p>
<p>Third step is to link the RHI texture reference from the step #1 with UTexture2D object from the step #2. It is done on the render thread by calling <em>RHIUpdateTextureReference</em>.</p>
<p>Now it is high time to ask why calling <em>RHIAsyncCreateTexture2D</em> works in the first place? Turns out it is related to the support of a concurrent resource creation by OS graphics driver. Fortunately the use of a Direct3D 11 device (ID3D11Device) is thread-safe. And that is what vanilla Unreal Engine 4 uses. Eureka! If one wants to find out more information then they should search for both <em>D3D11_FEATURE_DATA_THREADING</em> and <em>GRHISupportsAsyncTextureCreation</em> in Unreal codebase.</p>
<p>Full implementation of asynchronous texture creation is below:</p>
<pre><code class="language-cpp">const int32 TextureSizeX = 1024;
const int32 TextureSizeY = 1024;
EPixelFormat PixelFormat = EPixelFormat::PF_B8G8R8A8;
const int32 NumMips = 1;

// Mip0Data
const int32 Mip0Size = TextureSizeX * TextureSizeY * GPixelFormats[PixelFormat].BlockBytes;

TArray&lt;uint8&gt; Mip0Data;
Mip0Data.SetNum(Mip0Size);

// Fill Mip0Data;
// below &quot;green&quot; mip0 is constructed in a very bruteforce way
for (int32 Index = 0; Index &lt; Mip0Size; Index += 4)
{
	Mip0Data[Index] = 0;
	Mip0Data[Index + 1] = 255;
	Mip0Data[Index + 2] = 0;
	Mip0Data[Index + 3] = 255;
}

// make sure UTexture2D created on the game thread
// game thread task should be spawned in case this code is being executed on the separated thread
check (IsInGameThread());

// Create transient texture
UTexture2D* NewTexture = NewObject&lt;UTexture2D&gt;(
	GetTransientPackage(),
	MakeUniqueObjectName(GetTransientPackage(), UTexture2D::StaticClass(), *BaseFilename),
	RF_Transient
);
check(IsValid(NewTexture));

// never link the texture to Unreal streaming system
NewTexture-&gt;NeverStream = true;

{
	// allocate dummy mipmap of 1x1 size
	NewTexture-&gt;PlatformData = new FTexturePlatformData();
	NewTexture-&gt;PlatformData-&gt;SizeX = 1;
	NewTexture-&gt;PlatformData-&gt;SizeY = 1;
	NewTexture-&gt;PlatformData-&gt;PixelFormat = PixelFormat;

	FTexture2DMipMap* Mip = new FTexture2DMipMap();
	NewTexture-&gt;PlatformData-&gt;Mips.Add(Mip);
	Mip-&gt;SizeX = 1;
	Mip-&gt;SizeY = 1;

	// GPixelFormats contains meta information for each pixel format
	const uint32 MipBytes = Mip-&gt;SizeX * Mip-&gt;SizeY * GPixelFormats[PixelFormat].BlockBytes;
	{
		Mip-&gt;BulkData.Lock(LOCK_READ_WRITE);

		void* TextureData = Mip-&gt;BulkData.Realloc(MipBytes);

		static TArray&lt;uint8&gt; DummyBytes;
		DummyBytes.SetNum(MipBytes);

		FMemory::Memcpy(TextureData, DummyBytes.GetData(), MipBytes);

		Mip-&gt;BulkData.Unlock();
	}

	// construct texture
	NewTexture-&gt;UpdateResource();
}

// async create texture on the separate thread
FTexture2DRHIRef RHITexture2D;

Async(
	EAsyncExecution::Thread,
	[&amp;RHITexture2D, TextureSizeX, TextureSizeY, PixelFormat, NumMips, Mip0Data]
	{
		RHITexture2D = RHIAsyncCreateTexture2D(
			TextureSizeX, TextureSizeY,
			PixelFormat,
			NumMips,
			TexCreate_ShaderResource, Mip0Data.GetData(), NumMips
		);
	}
).Wait();

// link RHI texture to UTexture2D
ENQUEUE_RENDER_COMMAND(UpdateTextureReference)(
    [NewTexture, RHITexture2D](FRHICommandListImmediate&amp; RHICmdList)
    {
        RHIUpdateTextureReference(NewTexture-&gt;TextureReference.TextureReferenceRHI, RHITexture2D);
		NewTexture-&gt;RefreshSamplerStates();
    }
);

// now the texture is ready and can be used for shading/sampling/etc.

</code></pre>
<p>Note: the above code has to be modified depending on the thread where one wants to construct textures.</p>
<p><strong>Conclusion</strong></p>
<p>Overall this approach works well with the high resolution textures and also gives a great flexibility in terms of what and when the texture related objects should be created. For example, generating texture mips on the background thread and then uploading them to GPU via <em>RHICopySharedMips</em> is one of such examples. This approach is used in author&#x27;s Unreal plugin called <a href="https://www.unrealengine.com/marketplace/en-US/product/runtime-image-loader"><strong>RuntimeImageLoader</strong></a>, which is available on Unreal Marketplace!</p>
<p>The same approach can be applied to asynchronously create geometry buffers. Have fun!</p><hr style="margin-bottom:1.75rem"/><div><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0;margin-left:0"><li><a rel="prev" href="/blog/chasing_ue4_level_sequence_bug/">← <i>Level Sequence Optimization Tweaks in Unreal Engine 4</i></a></li><li><a rel="next" href="/blog/unreal_video_encoding/"><i>Cross platform and vendor agnostic runtime video recording solution for Unreal Engine 5</i> →</a></li></ul></div><div id="disqus_thread"></div></main></div></div><footer class="jsx-679949698"><i class="jsx-679949698">© <a href="/about/">Petr Leontev</a></i></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-BBXHR6HKTT"></script><script>
      window.excludeGtagPaths=[/^(?:\/preview\/(?:(?!(?:\/|^)\.).)*?)$/];
      function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='G-BBXHR6HKTT',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
      if(!(navigator.doNotTrack == "1" || window.doNotTrack == "1")) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-BBXHR6HKTT', {"optimize_id":"OPT_CONTAINER_ID","anonymize_ip":true,"cookie_expires":0,"send_page_view":false});gtag('config', 'UA-139915107-1', {"optimize_id":"OPT_CONTAINER_ID","anonymize_ip":true,"cookie_expires":0,"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/efficient_construction_of_textures/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-17bc563ab17e2c44db92.js\"],\"component---src-pages-about-js\":[\"/component---src-pages-about-js-c3494d30f7a62a4a7e4f.js\"],\"component---src-pages-index-js\":[\"/component---src-pages-index-js-e301c7038ba963027aa9.js\"],\"component---src-templates-blog-post-js-content-file-path-home-runner-work-raian-github-io-raian-github-io-content-blog-c-pointers-index-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-home-runner-work-raian-github-io-raian-github-io-content-blog-c-pointers-index-mdx-6aacd156f86e84ac1841.js\"],\"component---src-templates-blog-post-js-content-file-path-home-runner-work-raian-github-io-raian-github-io-content-blog-chasing-ue-4-level-sequence-bug-index-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-home-runner-work-raian-github-io-raian-github-io-content-blog-chasing-ue-4-level-sequence-bug-index-mdx-15d67e3602a8417c38c9.js\"],\"component---src-templates-blog-post-js-content-file-path-home-runner-work-raian-github-io-raian-github-io-content-blog-efficient-construction-of-textures-index-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-home-runner-work-raian-github-io-raian-github-io-content-blog-efficient-construction-of-textures-index-mdx-7b86174fb2f740748bf6.js\"],\"component---src-templates-blog-post-js-content-file-path-home-runner-work-raian-github-io-raian-github-io-content-blog-level-streaming-optimization-index-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-home-runner-work-raian-github-io-raian-github-io-content-blog-level-streaming-optimization-index-mdx-95a6fe0b0a932e79f6b3.js\"],\"component---src-templates-blog-post-js-content-file-path-home-runner-work-raian-github-io-raian-github-io-content-blog-motivation-index-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-home-runner-work-raian-github-io-raian-github-io-content-blog-motivation-index-mdx-baa4ab6c2189e1e8ddc4.js\"],\"component---src-templates-blog-post-js-content-file-path-home-runner-work-raian-github-io-raian-github-io-content-blog-unreal-cast-index-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-home-runner-work-raian-github-io-raian-github-io-content-blog-unreal-cast-index-mdx-fe56d52d26661232a165.js\"],\"component---src-templates-blog-post-js-content-file-path-home-runner-work-raian-github-io-raian-github-io-content-blog-unreal-video-encoding-index-mdx\":[\"/component---src-templates-blog-post-js-content-file-path-home-runner-work-raian-github-io-raian-github-io-content-blog-unreal-video-encoding-index-mdx-c9f2d16ba68a22351f07.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="3da37900212a9008f20a";</script><script src="/webpack-runtime-03160a84fba41fff12ff.js" async></script><script src="/framework-0d5fe34291110c57dcaf.js" async></script><script src="/app-17bc563ab17e2c44db92.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>